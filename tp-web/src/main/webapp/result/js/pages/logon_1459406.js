$(function(){if(isWeiXin()){var e=xigou.getLocalStorage("openid");if(!e)return void xigou.getwxOpenid(1,!0)}var o={uniontype:"1",unionval:e,signature:"af288db869b27f21cc1440385d63d4d5",curtime:(new Date).valueOf().toString()},t=xigou.getLocalStorage("dssUser");t&&"{}"!=t&&(t=JSON.parse(t),t&&t.mobile&&(o.shopMobile=t.mobile)),xigou.activeUser.unionlogon({requestBody:o,callback:function(e,t){if(t==xigou.dictionary.success){if(null==e)return;var i=e.code;switch(i){case"0":var a="";if(e.data.promoterinfo&&"{}"!=e.data.promoterinfo){var n=JSON.parse(e.data.promoterinfo);n.token=e.data.token,xigou.setLocalStorage("dssUser",n,!0)}var r=xigou.getSessionStorage("loginjump_url"),s={token:e.data.token,telephone:e.data.tel,name:e.data.name};xigou.removeSessionStorage("realname"),xigou.removeSessionStorage("realnum"),xigou.setSessionStorage("userinfo",s,!0),xigou.setLocalStorage("show_name",e.data.tel||e.data.name),xigou.setLocalStorage("token",e.data.token),xigou.getSessionStorage("refer_data")?(o=xigou.getSessionStorage("refer_data",!0),o.token=e.data.token,xigou.activeUser.addshopping({requestBody:o,callback:function(e,o){xigou.removeSessionStorage("refer_data"),o==xigou.dictionary.success||$.tips({content:"添加购物车失败！",stayTime:2e3,type:"warn"}),a="cart.html"}})):xigou.getSessionStorage("buy_now_refer_data")?(o=xigou.getSessionStorage("buy_now_refer_data",!0),o.token=e.data.token,xigou.activeUser.buynow({requestBody:o,callback:function(e,o){xigou.getSessionStorage("buy_now_tun_type");if(xigou.removeSessionStorage("buy_now_refer_data"),xigou.removeSessionStorage("buy_now_tun_type"),o==xigou.dictionary.success){var t=e||null;if(null==t||0==t.length)return!1;xigou.setSessionStorage("buy_now_uuid",t.data.uuid),a="settle.html"}else a=xigou.getSessionStorage("buy_now_details_url")}})):r?(xigou.setSessionStorage("loginjump_url",""),a=decodeURIComponent(r)):a=xigou.getSessionStorage("refer",!1).indexOf("login.html")>-1||xigou.getSessionStorage("refer",!1).indexOf("logon.html")>-1?"home.html":xigou.getSessionStorage("refer",!1).indexOf("/wxhb")>-1||xigou.getSessionStorage("refer",!1).indexOf("/wxhb.html")>-1?"home.html":"index.html",e.data.tel?setTimeout(function(){a="index.html"},250):(xigou.setSessionStorage("loginjump_url",a),window.location.href="forcebindtel.html");break;default:return}}}})});