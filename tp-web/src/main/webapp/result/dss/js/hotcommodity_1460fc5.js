function showItemDetail(e){function i(e){if(null==e||0==e.length)return!1;var i=[];i.push('<div class="ui-slider item-img-list">'),i.push('<ul class="ui-slider-content">');for(var t=0;t<e.length;t++)i.push("<li>"),i.push('	<a href="javascript:void(0);"><img src="'+e[t]+'"/></a>'),i.push("</li>");i.push("</ul>"),i.push("</div>"),$("#sliderlist").empty().html(i.join(""));new fz.Scroll(".item-img-list",{role:"slider",indicator:!0,autoplay:!0,interval:3e3,defaultIndex:1})}function t(e){if(void 0!=typeof e&&0!=e){var i="00",t="00",s=e.split(".");s.length>0&&(i=s[0],s.length>1&&(t=s[1]));var o='¥<span class="iem-price2">'+i+"</span>."+t;$("#iem-price")[0].innerHTML=o}}var s=$(e),o=s.attr("sku"),a=s.attr("tid"),n=null,l=xigou.getLocalStorage("dssUser");if(l&&"{}"!=l){var c=JSON.parse(l);n=c&&c.mobile&&c.token?c.mobile:null}xigou.activeProduct.details({p:"sku="+o+"&tid="+a+"&shopmobile="+n,showLoading:showLoading,callback:function(e,s){var o=e||null;if(s==xigou.dictionary.success&&e&&"0"==e.code){$("body").css("overflow","hidden"),$(".div_show_detail").removeClass("down").addClass("up"),$(".detail-content").hide(),$(".item_detail").show();{var a=o.data.imglist,n=isNaNDefaultInt(o.data.price),l=isNaNDefaultInt(o.data.oldprice);xigou.subDiscount(n,l)}"undefined"==o.data.name&&(o.data.name="");var c=o.data.name;"undefined"==o.data.feature&&(o.data.feature="");var r=o.data.feature,s=(o.data.specs,o.data.skus,o.data.stock,o.data.limitcount,o.data.status),d=(o.data.countryimg,o.data.commision);if(t(n),$("#old_price").text("¥"+l),i(a),o.data.salescountdesc&&($(".sale-count")[0].innerHTML=o.data.salescountdesc),$(".detail-content").html(o.data.detail),$(".dec-title")[0].innerHTML=c,$(".dec-info")[0].innerHTML=r,$("#contry-img").attr("src",o.data.countryimg),o.data.channel&&($(".warehouse")[0].innerHTML=o.data.channel),o.data.countryname&&($(".country-name")[0].innerHTML=o.data.countryname),d&&$("#fy_price").show().find("span").html("¥&nbsp;"+d),o.data.tags&&0!=o.data.tags.length){$(".div_promotion").show();for(var u=[],p=0;p<o.data.tags.length;p++){var g=o.data.tags[p];if(g&&g.tag)var h=g.fontcolor||"#ffffff",m=g.bgcolor||"#f57584",f=g.tag||" ";u.push('<span style="color: '+h+";background-color: "+m+'">'+f+"</span>")}$(".div_promotion_desc").empty(),$(".div_promotion_desc").append(u.join(" "))}else $(".div_promotion").hide();setShareItem(o.data)}}})}function hideItemDetail(){$(".item_detail").hide(),$("body").css("overflow","auto"),setShareItem()}function showItemPicDetail(){var e=$(".div_show_detail"),i=$(".detail-content");$(".div_show_detail")[xigou.events.click](function(){e.hasClass("up")?(e.removeClass("up").addClass("down"),i.show()):(e.removeClass("down").addClass("up"),i.hide())})}function setShareItem(e){if(!dssUserMobile){var i=xigou.getLocalStorage("dssUser");i&&"{}"!=i&&(i=JSON.parse(i),i.token&&i.token==xigou.getToken()&&(dssUserMobile=i.mobile||i.shopmobile))}e?(title=e.name,desc=e.feature,lineLink=xigou.activeHost+"item.html?tid="+e.tid+"&sku="+e.sku,imgUrl=e.imglist&&e.imglist.length>0?e.imglist[0]:xigou.activeHost+"img/bg_style1.png",dssUserMobile&&(lineLink=lineLink+"&shop="+dssUserMobile)):(title="西客商城｜是电商，也是shopping mall",desc="全国首家跨境生活综合体，线下商场与线上商城，同步更新，同享优惠。现在注册，立享150元优惠券，3月更多活动，精彩不断。",lineLink=xigou.activeHost+"shop.html",dssUserMobile&&(lineLink=lineLink+"?shop="+dssUserMobile),imgUrl=xigou.activeHost+"img/bg_style1.png"),wx.onMenuShareAppMessage({title:title,desc:desc,link:lineLink,imgUrl:imgUrl,trigger:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareTimeline({title:title,link:lineLink,imgUrl:imgUrl,trigger:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareQQ({title:title,desc:desc,link:lineLink,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareWeibo({title:title,desc:desc,link:lineLink,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareQZone({title:title,desc:desc,link:lineLink,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}})}function InitWeixin(){showLoading=!1,xigou.loading.open();var e=[],i=location.href.split("#")[0].replace(/&+/g,"%26");e.push("url="+i),xigou.activeUser.config({p:e.join("&"),showLoading:!1,callback:function(e,i){if(i==xigou.dictionary.success&&e&&0==e.code){var t=e.data;wx.config({appId:t.appid,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","scanQRCode"]})}}})}var title="",desc="",lineLink="",imgUrl="",showLoading=!0,dssUserMobile="";$(function(){function sgList(){$("#ClassifiedTitle li").live("click",function(){var e=$(this);if(itemIndex=e.index(),e.addClass("current").siblings("li").removeClass("current"),$(".lists").eq(itemIndex).show().siblings(".lists").hide(),!$(this).hasClass("zt")){if("Y"==$(this).attr("data-loadend"))return;{$(this).attr("data-topicid")}curPage=$(this).attr("curPage")||1,loadItemMax="N",dropload.unlock(),dropload.noData(!1),dropload.resetload()}}),$("#pGroup").on("click",function(){$(this);pGroupActive()})}function LoadItemInfo(e,i,t){return"Y"==loadItemMax?void $(".ui-refresh-down>span:first-child").removeClass():void xigou.promoterFunc.getopicitems({requestBody:{token:xigou.getToken(),type:1,topicid:e||"",topictype:3,curpage:i},showLoading:showLoading,async:!1,callback:function(e,i){if(i==xigou.dictionary.success)if(0==e.code){e.data.curpage==e.data.totalpagecount&&($("#ClassifiedTitle li").eq(itemIndex).attr("data-loadend","Y"),t.lock(),t.noData(),$(".dropload-down").hide());for(var s="",o=e.data.list,a=0;a<o.length;a++)s+='<li ng-repeat="x in topicItem"><a class="item_img" tid="'+o[a].topicid+'" sku="'+o[a].sku+'" onclick="showItemDetail(this)"><img src ='+o[a].imgurl+' /></a><p class = "dsc">'+o[a].name+'</p><p class="product_price">¥<span class="product_price_yuan">'+o[a].topicprice+'</span>&nbsp;<span class="product_old_price">¥'+o[a].saleprice+'</span></p><p class = "c2" style = "color:#999;font-size:14px;">返佣：<span class = "c1" style = "color:#ee3e54;">'+o[a].commission+'</span></p><p class = "fl s_state" style = "line-height: 23px;margin-top: 7px;"><i class = "icon'+o[a].onshelves+' fl show_state"  sku = "'+o[a].sku+'" topicid = "'+o[a].topicid+'" onshelves = "'+o[a].onshelves+'"></i><span>'+showState[o[a].onshelves]+"</span></p></li>";""==s&&(s='<li ng-repeat="x in topicItem"></li>'),$(".tab-content li.lists").eq(itemIndex).find(".all-content").append(s),t.resetload(),bindChangeClick(),curPage++,$(".ui-tab-nav li").eq(itemIndex).attr("curPage",curPage)}else $.tips({content:e.msg||"获取列表失败",stayTime:2e3,type:"warn"})}})}function bindChangeClick(){$(".show_state,.show_brand_state").on("click",function(){var c_clickFlag=(new Date).getTime();if(c_clickFlag-clickFlag>2e3){clickFlag=c_clickFlag;var _this=$(this),btnFlag=1==$(this).hasClass("show_state")?1:0,shelftype=btnFlag?1:0,onshelf_s=_this.attr("onshelves"),onshelf=eval(onshelf_s)?0:1,sku=_this.attr("sku"),topicid=_this.attr("topicid");xigou.promoterFunc.setshelves({requestBody:{token:xigou.getToken(),type:1,topicid:topicid,shelftype:shelftype,onshelf:onshelf,sku:sku,topictype:btnFlag?3:2},callback:function(e,i){i==xigou.dictionary.success&&(0==e.code?($.tips({content:e.msg,stayTime:2e3,type:"warn"}),_this.attr("onshelves",e.data.onshelves),btnFlag?(_this.siblings("span").text(showState[e.data.onshelves]),_this.removeClass("icon"+onshelf_s).addClass("icon"+onshelf)):_this.removeClass("rg-status"+onshelf_s).addClass("rg-status"+onshelf)):$.tips({content:e.msg||"操作失败",stayTime:2e3,type:"warn"}))}})}})}function pGroupActive(){dropload.lock(),dropload.noData(),$(".dropload-down").hide(),xigou.promoterFunc.getopics({requestBody:{token:xigou.getToken(),type:1,topictype:2},showLoading:showLoading,callback:function(e,i){if(i==xigou.dictionary.success)if(0==e.code){for(var t=e.data,s="",o=0;o<t.length;o++)s+='<div class ="zt-item"><a class = "zt_img" href = "brandList.html?topicid='+t[o].topicid+'"><img src='+t[o].image+' /></a><div class = "show_brand_state rg-status'+t[o].onshelves+'" topicid ="'+t[o].topicid+'" onshelves = "'+t[o].onshelves+'"></div></div>';if($("#b .zt-content").html(s),"brandList"==from){var a=$('a[href$="'+fromTopicid+'"]')[0];a&&setTimeout(function(){xigou.removeSessionStorage("fromTopicid"),fromTopicid="",a.scrollIntoView(!1)},500)}bindChangeClick(),s.length>0&&$(".cartnull").hide()}else $.tips({content:e.msg||"获取列表失败",stayTime:2e3,type:"warn"})}})}function Compute(e){var i=document.getElementById("dvCompute");return i.innerHTML=e,i.offsetWidth}isWeiXin()&&($(".header").hide(),$(".ui-header").css({height:"45px"}),$(".tab-content").css({"margin-top":"54px"}),$("title").html("选品上架"),$(".ui-tab-nav").css({top:"0","border-bottom":"none"}),$("#ClassifiedTitle.ui-tab-nav li.current").css({height:"46px","line-height":"46px"}),InitWeixin());var curPage=1,loadItemMax="N",itemIndex=0,showState=["未上架","已上架"],from=xigou.getQueryString("from"),fromTopicid=xigou.getSessionStorage("fromTopicid"),scroll,clickFlag=0;xigou.removeSessionStorage("speciallist"),xigou.removeSessionStorage("historypageshop"),xigou.removeSessionStorage("speciallist2"),xigou.removeSessionStorage("historypageshop2"),sgList(),showItemPicDetail(),xigou.promoterFunc.getopics({requestBody:{token:xigou.getToken(),type:1,topictype:3},showLoading:showLoading,callback:function(e,i){if(i==xigou.dictionary.success)if(0==e.code){for(var t="",s=e.data,o='<li class = "lists"><ul class = "all-content"></ul></li>',a=0;a<s.length;a++)t+="<li data-topicid="+s[a].topicid+">"+s[a].name+"</li>",$(".lists").eq(0).after(o);$("#all").after(t),scrolla=new fz.Scroll(".ui-scroller-a",{scrollX:!0}),"brandList"==from&&(scrolla._translate(scrolla.maxScrollX,0),$("#pGroup").trigger("click"))}else $.tips({content:e.msg||"获取列表失败",stayTime:2e3,type:"warn"})}});var dropload=$("body").dropload({scrollArea:window,loadDownFn:function(e){var i=$("li.current").attr("data-topicid")||"";LoadItemInfo(i,curPage,e)}})}),wx.ready(function(){wx.checkJsApi({jsApiList:["getNetworkType","previewImage"],success:function(){}}),setShareItem(),xigou.loading.close(),xigou.wxreadyalert()});