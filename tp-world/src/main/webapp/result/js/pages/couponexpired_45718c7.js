function expired(e,i){var o={token:xigou.getToken(),type:"1",status:"2",curpage:e};xigou.activeUser.haved({requestBody:o,callback:function(e,o){if(o==xigou.dictionary.success)if(null==e)$.tips({content:xigou.dictionary.chineseTips.server.value_is_null,stayTime:2e3,type:"warn"});else switch(e.code){case"0":expiredsetHtmlView(e);break;case"-100":var a=$.dialog({title:"",content:e.msg||"用户失效，请重新登录。",button:["确认"]});a.on("dialog:action",function(e){console.log(e.index),xigou.removelocalStorage("token"),window.location.href="logon.html"});break;default:$.tips({content:e.msg||"获取优惠券信息失败",stayTime:2e3,type:"warn"}),i.lock(),$(".dropload-down").hide()}else $.tips({content:"请求失败，详见"+e,stayTime:2e3,type:"warn"}),i.lock(),$(".dropload-down").hide()}})}function expiredsetHtmlView(e){var i={coupon0:[],coupon1:[],coupon2:[]};if(e&&e.data.list)for(var o in e.data.list){var a=e.data.list[o];i["coupon"+a.status].push(a)}for(var n='<div class="empty_box">没有可使用的优惠券</div>',l='<div class="ui-flex ui-flex-ver ui-flex-pack-center ui-flex-align-start"><div class="coupon-item" ><div class="coupon-expired-info"><div class="item_price"><span>¥</span><%=price%></div><div class="coupon-introduce"><div class="coupon-name"><%=name%></div><ul><li><%=validtime%></li><li><%=rule%></li></ul></div></div></div></div>',t='<div class="ui-flex ui-flex-ver ui-flex-pack-center ui-flex-align-start"><div class="card-item" ><div class="card-expired-info"><div class="item_price"><span>¥</span><%=price%></div><div class="card-introduce"><div class="card-name"><%=name%></div><ul><li><%=validtime%></li><li>可直接兑换成西客币</li></ul></div></div></div></div>',d=0;d<i.coupon2.length;d++){var c=[],s=i.coupon2[d];if("0"==s.type){var r=$.tpl(l,s);c.push(r),0==c.length?$(".coupon-expired").html(n):$(".coupon-expired").append(c.join(""))}else if("1"==s.exchangeXgMoney){var r=$.tpl(t,s);c.push(r),0==c.length?$(".card-expired").html(n):$(".card-expired").append(c.join(""))}else{var r=$.tpl(l,s);c.push(r),0==c.length?$(".card-expired").html(n):$(".card-expired").append(c.join(""))}}}$(function(){var e=1;xigou.getLoginUserInfo({callback:function(i,o){o==xigou.dictionary.success?$(".coupon-expired").dropload({scrollArea:window,loadDownFn:function(i){expired(e,i),i.resetload(),1==e&&$(".dropload-refresh").hide(),e++}}):window.location.href="index.html"}})});