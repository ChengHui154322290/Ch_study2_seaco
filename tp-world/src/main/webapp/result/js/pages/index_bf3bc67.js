function setShopName(e){if(e.mobile||e.shopmobile){var i="";i=e.nickname||e.shopnickname?e.nickname||e.shopnickname:e.name,isWeiXin()?i?($(".home-name-val").html(i+"的西客屋"),$("title").html(i+"的西客屋")):$(".home-name-val").html("西客商城"):$(".home-name-val").html(i?i+"的西客屋":"西客商城")}}function dssShareShop(e){isWeiXin()?e?($(".home-name-val").html(e+"的西客屋"),$("title").html(e+"的西客屋")):$(".home-name-val").html("西客商城"):$(".home-name-val").html(e?e+"的西客屋":"西客商城")}function dssIndex(){$("#slider").hide(),$(".ui-header").hide(),$(".div_top_icon").hide(),$(".div_top_icon1").show(),$(".ui-header-a").show(),$(".content").css("margin-top","0px"),$("#backDsshome").attr("href","dss/dsshome.html"),"dsshome"==fromDsshome&&$(".home-name a").addClass("act")}function getDssUserInfo(){var e=xigou.getLocalStorage("dssUser"),i=xigou.getQueryString("shop"),s=xigou.getSessionStorage("shareShop"),o=xigou.getSessionStorage("DssName");if(s&&"null"!=s&&"undefined"!=s)return dssUserMobile=s,dssName=o,dssShareShop(dssName),void wxunionlogin(s);var s=xigou.getQueryString("shop"),o=xigou.getQueryString("dssName");if(o&&"null"!=o)var o=o.split("&")[0];if(xigou.setSessionStorage("shareShop",s),xigou.setSessionStorage("DssName",o),s&&"undefined"!=s)return dssUserMobile=s,dssName=o,dssShareShop(dssName),void wxunionlogin(s);if(e&&"{}"!=e){if(e=JSON.parse(e),e.token&&e.token==xigou.getToken()&&(e.mobile||e.shopmobile))return setShopName(e),dssUserMobile=e.mobile||e.shopmobile,dssName=e.nickname||e.shopnickname||name,void wxunionlogin(dssUserMobile);if(!i)return setShopName(e),dssUserMobile=e.mobile||e.shopmobile,dssName=e.nickname||e.shopnickname||name,void wxunionlogin(dssUserMobile)}xigou.getDssUserInfo({requestBody:{shop:xigou.getQueryString("shop"),token:xigou.getToken(),priority:0},callback:function(e,s){s==xigou.dictionary.success&&null!=e&&e.mobile?(dssUserMobile=e.mobile,0==parseInt(e.source)?dssUserMobile.token=xigou.getToken():dssUserMobile.shop=i,(null==xigou.getLocalStorage("dssUser",!0)||""==xigou.getLocalStorage("dssUser",!0)||"{}"==xigou.getLocalStorage("dssUser",!0)||xigou.getLocalStorage("dssUser",e,!0).mobile!=e.mobile)&&xigou.setLocalStorage("dssUser",e,!0),setShopName(e),wxunionlogin(dssUserMobile)):wxunionlogin()}})}function moduleInfo(){function e(e){if(e&&0!=e.length){var i=[];i.push('<div class="ui-slider">'),i.push('<ul class="ui-slider-content">');for(var o=0;o<e.length;o++){var a=s(e[o]).split("com")[1];i.push("<li>"),i.push(a&&"undefined"!=a?'	<a href="'+a+'">':'	<a href="'+s(e[o])+'">'),i.push('	<img src="'+e[o].imageurl+'"/>'),i.push("	</a>"),i.push("</li>"),0==o&&(imgUrl=e[o].imageurl)}i.push("</ul>"),i.push("</div>"),$("#slider").empty().html(i.join(""));{new fz.Scroll(".ui-slider",{role:"slider",indicator:!0,autoplay:!0,interval:3e3})}}}function i(e){for(var i=[],s=[],o=0;o<e.length;o++){o>0&&o%maxLabsElementCnt==0&&(s.push('<div class="div_top_icon">'+i.join("")+"</div>"),i=[]);var a=e[o].linkurl.split("com")[1];i.push(a&&"undefined"!=a?'<div><a class="error" href="'+a+'"><img src="'+e[o].imageurl+'">'+e[o].title+"</a></div>":'<div><a class="error" href="'+e[o].linkurl+'"><img src="'+e[o].imageurl+'">'+e[o].title+"</a></div>")}s.push('<div class="div_top_icon">'+i.join("")+"</div>"),$(".div_top_lab").html(s.join("")),$(".div_top_lab").show()}function s(e){var i=e.content.text,s=e.content.tid,o=e.content.sku;switch(e.type){case"0":i+=i.indexOf("?")<0?"?mtoapp=0":"&mtoapp=0";break;case"1":i="hd.htm?tid="+s;break;case"2":i="item.htm?tid="+s+"&sku="+o;break;case"3":i="spike.html?mtoapp=3";break;case"4":i="cart.html?mtoapp=4";break;case"5":i="logon.html";break;case"6":i="registr.html";break;case"7":i="coupon.html?mtoapp=7";break;case"8":i="coupon.html?mtoapp=7";break;case"9":i="orders.html";break;case"10":i="aftersaleslist.html";break;case"11":i="home.html";break;case"12":i="sign.html";break;case"13":i="group_buying.html";break;case"14":i="search.html?key="+i;break;case"15":i="search.html?brandid="+s+"&name="+i;break;case"16":i="search.html?categoryid= "+s+"&name="+i;break;default:i="javascript:void(0);"}return i}xigou.activeIndex.module({showLoading:showLoading,callback:function(s,o){if(o==xigou.dictionary.success){var a=s||null;if(null==a||0==a.length)return!1;var t=a.code;if(0==t){if(!s.data)return;e(s.data.banners),i(s.data.labs)}}}})}function todayHave(e,i,s){"Y"==todayHave_max&&(isScrolling=!1,$(".dropload-down").hide(),$(".ui-refresh-down>span:first-child").removeClass()),"Y"!=todayHave_max&&xigou.activeIndex.todayHave({p:"curpage="+e+"&shopmobile="+s,showLoading:!1,callback:function(o,a){if(isScrolling=!1,$("#todayNew_product_group_item .ui-refresh-down").remove(),a==xigou.dictionary.success){var t=o||null;if(null==t||0==t.length)return!1;var n=t.code;if(0==n){if("undefined"==typeof o.data){if(todayHave_max="Y",$(".dropload-down").hide(),i&&i.lock(),1==e){$("#indexlists").empty(),$("#indexlists").append('<div class="div_empty"></div>');var l=!1,r=xigou.getLocalStorage("dssUser");r&&"{}"!=r&&(r=JSON.parse(r),r.token&&r.token==xigou.getToken()&&(l=!0)),l?($("#indexlists").append('<div class="div_empty_desc">你还木有可售商品，快去添加哟</div>'),$("#indexlists").append('<a href="dss/hotcommodity.html"><div class="div_go_add">选品上架</div></a>')):$("#indexlists").append('<div class="div_empty_desc">该店铺木有商品哟!</div>')}return}if(null==o.data.list||0==o.data.list.length){if(todayHave_max="Y",$(".dropload-down").hide(),i&&i.lock(),1==e){$("#indexlists").empty(),$("#indexlists").append('<div class="div_empty"></div>');var l=!1,r=xigou.getLocalStorage("dssUser");r&&"{}"!=r&&(r=JSON.parse(r),r.token&&r.token==xigou.getToken()&&(l=!0)),l?($("#indexlists").append('<div class="div_empty_desc">你还木有可售商品，快去添加哟</div>'),$("#indexlists").append('<a href="dss/hotcommodity.html"><div class="div_go_add">选品上架</div></a>')):$("#indexlists").append('<div class="div_empty_desc">该店铺木有商品哟!</div>')}return}if(null!=o.data.list&&o.data.list.length>0){var d=createItemData(o.data.list);1==e&&$("#indexlists").empty(),d.length>0&&$("#indexlists").append(d.join(" ")),$(".ui-imglazyload").imglazyload(),$(".todayHave").each(function(e,i){var s=Date.parse(new Date),o=$(i).attr("endtime");getTimeRest(s,o,$(i))});{JSON.stringify(o.data.list)}1==e&&xigou.setSessionStorage("speciallist2","");var c=xigou.getSessionStorage("speciallist2");if(c){for(var u=o.data.list,p=JSON.parse(c),h=0,g=u.length;g>h;h++)p.push(u[h]);xigou.setSessionStorage("speciallist2",JSON.stringify(p))}xigou.setSessionStorage("historypage2",e),xigou.setSessionStorage("historypageshop2",s),$(".ui-scroller-a").each(function(e,i){new fz.Scroll(i,{scrollX:!0})})}}}}})}function loadHistoryData(){listCount=xigou.getSessionStorage("historypage2");var e=xigou.getSessionStorage("speciallist2");if(e){var i=JSON.parse(e),s=createItemData(i);if(s.length>0)$("#indexlists").append(s.join(" "));else{$("#indexlists").append('<div class="div_empty"></div>');var o=!1,a=xigou.getLocalStorage("dssUser");a&&"{}"!=a&&(a=JSON.parse(a),a.token&&a.token==xigou.getToken()&&(o=!0,alert(1))),o?($("#indexlists").append('<div class="div_empty_desc">你还木有可售商品，快去添加哟</div>'),$("#indexlists").append('<a href="dss/hotcommodity.html"><div class="div_go_add">选品上架</div></a>')):$("#indexlists").append('<div class="div_empty_desc">该店铺木有商品哟!</div>')}$(".ui-imglazyload").imglazyload(),$(".todayHave").each(function(e,i){var s=Date.parse(new Date),o=$(i).attr("endtime");getTimeRest(s,o,$(i))});var t=xigou.getSessionStorage("specialid"),n=xigou.getSessionStorage("specialSku");if(n){var l=$('a[href$="'+n+'"]')[0];l&&setTimeout(function(){l.scrollIntoView()},500)}else if(t){var l=$('a[href$="'+t+'"]')[0];l&&setTimeout(function(){l.scrollIntoView()},500)}$(".ui-scroller-a").each(function(e,i){new fz.Scroll(i,{scrollX:!0})}),xigou.setSessionStorage("specialid",""),xigou.setSessionStorage("specialSku","")}}function solveNull(e,i){return null==e||"undefined"==typeof e?i:e}function InitWeixin(){xigou.loading.open();var e=[],i=location.href.split("#")[0].replace(/&+/g,"%26");e.push("url="+i),xigou.activeUser.config({p:e.join("&"),showLoading:!1,callback:function(e,i){if(i==xigou.dictionary.success&&e&&0==e.code){var s=e.data;wx.config({appId:s.appid,timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","scanQRCode"]})}}})}function wxunionlogin(e){InitPage(e)}function InitPage(e){moduleInfo(),loadGroupBuyList(groupBuyPage++,null),xigou.setSessionStorage("productdetails_backurl",window.location.href);var i=xigou.getLocalStorage("dssUser");if(i){var s=JSON.parse(i);showFlag=s.mobile&&s.token?!0:!1,showFlag&&$(".div_icon").show()}var i=xigou.getLocalStorage("dssUser");if(i){var s=JSON.parse(i);showFlag=s.mobile&&s.token?!0:!1,showFlag?$(".div_icon").show():($(".dsshomeBtn").hide(),$(".home-name").addClass("centerAlign"))}$(".dropload-refresh").hide(),xigou.getSessionStorage("speciallist2")&&(null==e&&"null"==xigou.getSessionStorage("historypageshop2")||xigou.getSessionStorage("historypageshop2")==e)?loadHistoryData():todayHave(listCount,null,e),listCount++,$(".content").dropload({scrollArea:window,loadDownFn:function(i){i.resetload(),todayHave(listCount,i,e),listCount++}}),isWeiXin()&&InitWeixin()}function createItemData(e){var i=[];return $.each(e,function(e,s){if(1==s.type){var o=s.price.split(".")[0]||"00",a=s.price.split(".")[1]||"00";s.countryname||(s.countryname=""),s.channel||(s.channel=""),i.push('<a href="item.htm?tid='+s.tid+"&sku="+s.sku+'">'),i.push('<div class="div_item ssale_desc_bottom">'),i.push('		<div class="div_item_img">'),i.push('			<img src="'+s.imgurl+'">'),i.push("		</div>"),i.push('		<div class="div_item_desc">'),i.push('			<div class="div_desc">'),s.countryimg&&i.push('<img class="contry-img" src="'+s.countryimg+'">'),s.countryname&&i.push('<span class="country-info">'+s.countryname+"</span>"),s.channel&&i.push('<span class="country-info">'+s.channel+"</span>"),i.push("			</div>"),i.push('			<div class="div_name">'+s.name+"</div>"),i.push("		</div>"),i.push('		<div class="div_price_info">'),i.push('			<div class="new_price">¥<span>'+o+"</span>."+a+"</div>"),i.push(dssUserMobile&&s.commision&&showFlag?'<div class="old_price"><span>¥'+s.oldprice+' </span>&nbsp;&nbsp;返佣：<span class="return">¥'+s.commision+"</span></div>":'<div class="old_price"><span>¥'+s.oldprice+" </span></div>"),i.push("		</div>"),i.push("	</div>"),i.push("</a>")}else if(2==s.type){i.push('<a href="hd.htm?tid='+s.tid+'&from=shop" class="hot_link"">'),i.push(s.itemlist&&s.itemlist.length>0?'<p class = "div_img">':'<p class = "div_img div_none_item">'),i.push('	<img class="ui-imglazyload" data-url="'+s.imgurl+'"/>'),i.push("</a>"),i.push("</p>");var t=Math.round($(".content").width()/3.8),n=Math.round(t+70);if(dssUserMobile&&showFlag&&(n+=15),s.itemlist&&s.itemlist.length>0){i.push('<div style = "height:'+n+'px" class="ui-scroller-a seckill-new-container">'),i.push('<ul class="ui-slider-content">');for(var l=s.itemlist,r=0;r<l.length;r++){var d=l[r].price.split(".")[0],c=l[r].price.split(".")[1];i.push('<li style = "width:'+t+'px"><a class="error_tuan" style="display:block;width:100%;height:'+t+'px;overflow: hidden;" href="item.htm?tid='+l[r].tid+"&sku="+l[r].sku+'"><img src = '+l[r].imgurl+" /></a>"),i.push('<div class="seckill-item-price">'),i.push('<span class="seckill-new-title">'+l[r].name+"</span>"),i.push('<span class="seckill-new-price"><b class = "mS">¥</b>'+d+'<b class = "mB">.'+c+'</b><b class="mS" style = "padding-left:0.5em;color:#999;text-decoration:line-through;">¥'+l[r].oldprice+"</b></span>"),dssUserMobile&&l[r].commision&&showFlag&&i.push('<span class="span_return">返佣：<span>¥'+l[r].commision+"</span></span>"),i.push("</div></li>")}i.push('<li><a href="hd.htm?tid='+s.tid+'"><img src = "img/zt_more.png" /></a></li>'),i.push("</ul>"),i.push("</div>")}}}),i}function loadGroupBuyList(e,i){var s={page:e,callback:function(e,s){s==xigou.dictionary.success?0==e.code?LoadTuanListData(i,e.data):$.tips({content:e.msg||"获取数据失败,请检测网络连接!",stayTime:2e3,type:"warn"}):$.tips(e?{content:e.msg||"获取数据失败,请检测网络连接!",stayTime:2e3,type:"warn"}:{content:"获取数据失败,请检测网络连接!",stayTime:2e3,type:"warn"})}};xigou.groupbuy.listforindex(s)}function LoadTuanListData(e,i){if(!i||!i.list||0==i.list.length)return bMaxPage=!0,void(e&&e.lock());var s=[],o=Math.round($(".content").width()/3.8),a=Math.round(o+42);if(dssUserMobile&&showFlag&&(a+=15),i.list&&i.list.length>0){s.push('<div style = "height:'+a+'px" class="ui-scroller-a seckill-new-container">'),s.push('<ul class="ui-slider-content">');for(var t=i.list,n=0;n<t.length;n++)s.push('<li style = "width:'+o+'px;"><a class="error_tuan" style="display:block;width:100%;height:'+o+'px;overflow: hidden; border: 1px solid #e8e8e8;" href="tuan.html?gbid='+t[n].gbid+'"><img src = '+t[n].imgurl+" /></a>"),s.push('<div class="seckill-item-price">'),s.push('<span class="group-new-price"><b class="groupnub"><b class="lP">'+t[n].pa+'</b>人团</b><b class = "lS">¥</b><b class="lG">'+t[n].groupprice+"</b></span>"),s.push("</div></li>");s.push('<li><a href="tuanlist.html"><img src = "img/zt_more.png" /></a></li>'),s.push("</ul>"),s.push("</div>")}$(".groupconfigure").show(),$(".tuanlist").append(s.join(" ")),$(".tuan_show_more").on("click",function(){window.location.href="tuanlist.html"}),i.curpage==i.totalpagecount&&(bMaxPage=!0,e&&e.lock(),$(".dropload-down").hide()),$(".ui-scroller-a").each(function(e,i){new fz.Scroll(i,{scrollX:!0})})}var refreshComp,myScroll,listCount=1,firstssale=!0,imgUrl="",dssUserMobile=null,dssName=null,fromDsshome=xigou.getQueryString("from"),showFlag="",showLoading=!0,groupBuyPage=1,bMaxPage=!1,maxLabsElementCnt=5;$(function(){isWeiXin()&&($(".ui-header").hide(),$(".header_wx").show(),$(".content").css({"margin-top":"0px"}),showLoading=!1),getDssUserInfo(),window.onscroll=function(){var e=document.documentElement.scrollTop||document.body.scrollTop;e>30?$(".home-name").addClass("fixed"):30>e&&$(".home-name").removeClass("fixed");var i=2*$(window).height();e>i?$(".top").show():$(".top").hide()}});var todayHave_max="N";wx.ready(function(){wx.checkJsApi({jsApiList:["getNetworkType","previewImage"],success:function(){}});var e=location.href.split("?")[0];null!=dssUserMobile&&"undefined"!=dssUserMobile&&""!=dssUserMobile&&(e=e+"?shop="+dssUserMobile+"&dssName="+dssName);var i="西客屋",s="一键式轻创业模式， 用更少的钱体验全球品质生活";wx.onMenuShareAppMessage({title:i,desc:s,link:e,imgUrl:imgUrl,trigger:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareTimeline({title:i,link:e,imgUrl:imgUrl,trigger:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareQQ({title:i,desc:s,link:e,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareWeibo({title:i,desc:s,link:e,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}}),wx.onMenuShareQZone({title:i,desc:s,link:e,imgUrl:imgUrl,trigger:function(){},complete:function(){},success:function(){},cancel:function(){},fail:function(){}}),$("#index_scan, #index_scan1").on("click",function(){wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){var i=JSON.stringify(e).substring(14,34);"http://w.51seaco.com"==i||"https://w.51seaco.com"==i?window.location.href=e.resultStr:"http://weixin.qq.com"==i?wx.scanQRCode():$.tips({content:"小西不支持的消息格式！",stayTime:2e3,type:"warn"})}})}),xigou.loading.close(),xigou.wxreadyalert()}),wx.error(function(){});