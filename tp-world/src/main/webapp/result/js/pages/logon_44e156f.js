$(function(){var e=xigou.getLocalStorage("dssUser");e&&"{}"!=e&&(e=JSON.parse(e),e&&e.mobile&&(t.shopMobile=e.mobile));var o=xigou.getToken();if(o){var t={token:xigou.getToken()};xigou.activeUser.unionlogon({requestBody:t,callback:function(e,o){if(o==xigou.dictionary.success){if(null==e)return;var a=e.code;switch(a){case"0":var i="";if(e.data.promoterinfo&&"{}"!=e.data.promoterinfo){var n=JSON.parse(e.data.promoterinfo);n.token=e.data.token,xigou.setLocalStorage("dssUser",n,!0)}var r=xigou.getSessionStorage("loginjump_url"),s={token:e.data.token,telephone:e.data.tel,name:e.data.name};xigou.removeSessionStorage("realname"),xigou.removeSessionStorage("realnum"),xigou.setSessionStorage("userinfo",s,!0),xigou.setLocalStorage("show_name",e.data.tel||e.data.name),xigou.setLocalStorage("token",e.data.token),xigou.getSessionStorage("refer_data")?(t=xigou.getSessionStorage("refer_data",!0),t.token=e.data.token,xigou.activeUser.addshopping({requestBody:t,callback:function(e,o){xigou.removeSessionStorage("refer_data"),o==xigou.dictionary.success||$.tips({content:"添加购物车失败！",stayTime:2e3,type:"warn"}),i="cart.html"}})):xigou.getSessionStorage("buy_now_refer_data")?(t=xigou.getSessionStorage("buy_now_refer_data",!0),t.token=e.data.token,xigou.activeUser.buynow({requestBody:t,callback:function(e,o){xigou.getSessionStorage("buy_now_tun_type");if(xigou.removeSessionStorage("buy_now_refer_data"),xigou.removeSessionStorage("buy_now_tun_type"),o==xigou.dictionary.success){var t=e||null;if(null==t||0==t.length)return!1;xigou.setSessionStorage("buy_now_uuid",t.data.uuid),i="settle.html"}else i=xigou.getSessionStorage("buy_now_details_url")}})):r?(xigou.setSessionStorage("loginjump_url",""),i=decodeURIComponent(r)):i=xigou.getSessionStorage("refer",!1).indexOf("login.html")>-1||xigou.getSessionStorage("refer",!1).indexOf("logon.html")>-1?"home.html":xigou.getSessionStorage("refer",!1).indexOf("/wxhb")>-1||xigou.getSessionStorage("refer",!1).indexOf("/wxhb.html")>-1?"home.html":"index.html",e.data.tel?setTimeout(function(){i="index.html"},250):(xigou.setSessionStorage("loginjump_url",i),window.location.href="forcebindtel.html");break;default:return}}}})}});