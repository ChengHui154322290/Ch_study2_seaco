function getopenid(e){xigou.getQueryString("getNickName")?(xigou.setSessionStorage("getediconnickname",!0),xigou.activeUser.wxInfo({requestBody:{code:e},callback:function(e){e&&"0"==e.code&&(e.data.openid&&xigou.setSessionStorage("openid",e.data.openid),e.data.headimgurl&&xigou.setSessionStorage("wxImage",e.data.headimgurl),e.data.nickname&&xigou.setSessionStorage("wxnickname",e.data.nickname));var o=decodeURIComponent(xigou.getQueryString("back_url"))||"http://m.51seaco.com/index.html";o=/^.*\.html?$/.test(o)?o+"?openid="+e.data.openid+"&wxImage="+e.data.headimgurl+"&wxnickname="+e.data.nickname:o+"&openid="+e.data.openid+"&wxImage="+e.data.headimgurl+"&wxnickname="+e.data.nickname,window.location.href=o}})):xigou.activeUser.openid({requestBody:{code:e},callback:function(e){xigou.setSessionStorage("openid",e.data.openid);var o=decodeURIComponent(xigou.getQueryString("back_url"))||"http://m.51seaco.com/index.html";o=/^.*\.html?$/.test(o)?o+"?openid="+e.data.openid:o+"&openid="+e.data.openid,window.location.href=o}})}$(function(){var e=decodeURIComponent(xigou.getQueryString("back_url"))||"http://m.51seaco.com/index.html",o=window.navigator.userAgent.toLowerCase();if("micromessenger"!=o.match(/MicroMessenger/i))return void(window.location.href=e);var i=xigou.getSessionStorage("openid");if("null"==i&&(i=null),i||(i=xigou.getQueryString("openid")),null!=i&&!xigou.getQueryString("getNickName"))return e=/^.*\.html?$/.test(e)?e+"?openid="+i:e+"&openid="+i,void(window.location.href=e);if(i&&xigou.getQueryString("getNickName")){var n=xigou.getSessionStorage("wxImage"),t=xigou.getSessionStorage("wxnickname");n||(n=xigou.getQueryString("wxImage")),t||(t=xigou.getQueryString("wxnickname")),i&&n&&t&&(e=/^.*\.html?$/.test(e)?e+"?openid="+i+"&wxImage="+n+"&wxnickname="+t:e+"&openid="+i+"&wxImage="+n+"&wxnickname="+t,window.location.href=e)}var a=xigou.getQueryString("code");if(a)return void getopenid(a);var g={url:encodeURIComponent(window.location.href)};g.scope=xigou.getQueryString("getNickName")?"snsapi_userinfo":"snsapi_base",xigou.activeUser.getcode({requestBody:g,callback:function(e){var o=e.data.codeurl||"http://m.51seaco.com/index.html";o&&(window.location.href=o)}})});