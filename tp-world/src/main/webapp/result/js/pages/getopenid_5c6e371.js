function getopenid(e){xigou.getQueryString("getNickName")?(xigou.setSessionStorage("getediconnickname",!0),xigou.activeUser.wxInfo({requestBody:{code:e},callback:function(e){e&&"0"==e.code&&(e.data.openid&&xigou.setLocalStorage("openid",e.data.openid),e.data.headimgurl&&xigou.setLocalStorage("wxImage",e.data.headimgurl),e.data.nickname&&xigou.setLocalStorage("wxnickname",e.data.nickname));var o=decodeURIComponent(xigou.getQueryString("back_url"))||"//m.51seaco.com/index.html";o=/^.*\.html?$/.test(o)||o.endWith("/")?o+"?openid="+e.data.openid+"&wxImage="+e.data.headimgurl+"&wxnickname="+e.data.nickname:o+"&openid="+e.data.openid+"&wxImage="+e.data.headimgurl+"&wxnickname="+e.data.nickname,window.location.href=o}})):xigou.activeUser.openid({requestBody:{code:e},callback:function(e){xigou.setLocalStorage("openid",e.data.openid);var o=decodeURIComponent(xigou.getQueryString("back_url"))||"//m.51seaco.com/index.html";o=/^.*\.html?$/.test(o)||o.endWith("/")?o+"?openid="+e.data.openid:o+"&openid="+e.data.openid,window.location.href=o}})}$(function(){var e=decodeURIComponent(xigou.getQueryString("back_url"))||"//m.51seaco.com/index.html",o=window.navigator.userAgent.toLowerCase();if("micromessenger"!=o.match(/MicroMessenger/i))return void(window.location.href=e);var i=xigou.getLocalStorage("openid");if(i||(i=xigou.getQueryString("openid")),i&&!xigou.getQueryString("getNickName"))return e=/^.*\.html?$/.test(e)||e.endWith("/")?e+"?openid="+i:e+"&openid="+i,void(window.location.href=e);if(i&&xigou.getQueryString("getNickName")){var a=xigou.getLocalStorage("wxImage"),n=xigou.getLocalStorage("wxnickname");a||(a=xigou.getQueryString("wxImage")),n||(n=xigou.getQueryString("wxnickname")),i&&a&&n&&(e=/^.*\.html?$/.test(e)||e.endWith("/")?e+"?openid="+i+"&wxImage="+a+"&wxnickname="+n:e+"&openid="+i+"&wxImage="+a+"&wxnickname="+n,window.location.href=e)}var t=xigou.getQueryString("code");if(t)return void getopenid(t);var g={url:encodeURIComponent(window.location.href)};g.scope=xigou.getQueryString("getNickName")?"snsapi_userinfo":"snsapi_base",xigou.activeUser.getcode({requestBody:g,callback:function(e){var o=e.data.codeurl||"//m.51seaco.com/index.html";o&&(window.location.href=o)}})});