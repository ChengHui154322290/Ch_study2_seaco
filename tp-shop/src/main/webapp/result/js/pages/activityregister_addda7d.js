$(function(){function e(){$(".top_tip")[xigou.events.click](function(){$(".div_attention").show()}),$(".close_attention")[xigou.events.click](function(){$(".div_attention").hide()})}function t(){$(".register-register")[xigou.events.click](function(){var e={loginname:$("#input-telnum").val(),captcha:$("#input-code").val(),pwd:$("#input-pwd").val()};isWeiXin()&&(e.uniontype="1",e.unionval=xigou.getLocalStorage("openid"));var t={requestBody:e,callback:function(e,t){if(t==xigou.dictionary.success)if(null==e)$.tips({content:xigou.dictionary.chineseTips.server.value_is_null,stayTime:2e3,type:"warn"});else{var i=e.code;switch(xigou.debugPrint("注册成功返回的code值："+i),i){case"0":n(e.data.token);break;case"-2":$.tips({content:e.msg||"验证码错误",stayTime:2e3,type:"warn"});break;default:$.tips({content:e.msg||"注册失败",stayTime:2e3,type:"warn"})}}else xigou.alert("请求失败，详见"+e)}};xigou.activeUser.registr(t)})}function i(){function e(e){var t=$(".register-btn");t.text(e);var i=setInterval(function(){return 0>=e?(clearInterval(i),t.text("获取验证码"),void $(".register-btn").removeClass("disable")):void t.text(--e)},1e3)}$(".register-btn")[xigou.events.click](function(){if(!$(".register-btn").hasClass("disable")){var t={tel:$(".input-telnum").val(),type:"1"},i={requestBody:t,callback:function(t,i){if(i==xigou.dictionary.success)if(null==t)$.tips({content:xigou.dictionary.chineseTips.server.value_is_null,stayTime:2e3,type:"warn"});else{var n=t.code;switch(n){case"0":$(".register-btn").addClass("disable"),e(60);break;default:$.tips({content:t.msg||"获取验证码失败",stayTime:2e3,type:"warn"})}}else $.tips({content:"请求失败，详见"+t,stayTime:2e3,type:"warn"})}};xigou.activeUser.getTheCode(i)}})}function n(e){var t={token:e};xigou.activeUser.offlinecouponcode({requestBody:t,callback:function(e,t){t==xigou.dictionary.success&&0==e.code?($(".div_step_1").hide(),$(".div_step_2").show(),e.data.qrcode&&$(".div_code_bg").html('<img src="'+e.data.qrcode+'">')):$.tips(e&&e.msg?{content:e.msg,stayTime:2e3,type:"warn"}:{content:"获取获取线下活动的兑换码失败",stayTime:2e3,type:"warn"})}})}if(isWeiXin()){var s=xigou.getLocalStorage("openid");if(!s)return void xigou.getwxOpenid()}e(),i(),t()});