function login(){var e=$("body").height(),o=$(window).height();$(".logo").css("top",.92*Math.max(e,o)-42+"px");var t=xigou.getLocalStorage("login_name");t&&""!=t&&"null"!=t&&"undefined"!=t&&void 0!=t&&$("input.name").val(t),$("#loginBtnID")[xigou.events.click](function(){if($("#loginBtnID").focus(),xigou.valiformdata.check(null,valiDataCallBack)){var e={token:"",loginname:$("input.name").val(),pwd:$("input.pwd").val()},o={requestBody:e,callback:function(o,t){if(t==xigou.dictionary.success)if(null==o)$.tips({content:xigou.dictionary.chineseTips.server.value_is_null,stayTime:2e3,type:"warn"});else{var i=o.code;switch(i){case"0":if(o.data.promoterinfo&&"{}"!=o.data.promoterinfo){var a=JSON.parse(o.data.promoterinfo);a.token=o.data.token,xigou.setSessionStorage("dssUser",a,!0)}var n=xigou.getSessionStorage("loginjump_url"),r={token:o.data.token,telephone:o.data.tel,name:o.data.name};if(xigou.removeSessionStorage("realname"),xigou.removeSessionStorage("realnum"),xigou.setSessionStorage("userinfo",r,!0),$("input.name").val()&&xigou.setLocalStorage("login_name",$("input.name").val()),xigou.setLocalStorage("show_name",o.data.tel||o.data.name),xigou.setLocalStorage("token",o.data.token),xigou.getSessionStorage("refer_data"))e=xigou.getSessionStorage("refer_data",!0),e.token=o.data.token,xigou.activeUser.addshopping({requestBody:e,callback:function(e,o){xigou.removeSessionStorage("refer_data"),o==xigou.dictionary.success||$.tips({content:"添加购物车失败！",stayTime:2e3,type:"warn"}),window.location.href="cart.html"}});else if(xigou.getSessionStorage("buy_now_refer_data"))e=xigou.getSessionStorage("buy_now_refer_data",!0),e.token=o.data.token,xigou.activeUser.buynow({requestBody:e,callback:function(e,o){xigou.getSessionStorage("buy_now_tun_type");if(xigou.removeSessionStorage("buy_now_refer_data"),xigou.removeSessionStorage("buy_now_tun_type"),o==xigou.dictionary.success){var t=e||null;if(null==t||0==t.length)return!1;xigou.setSessionStorage("buy_now_uuid",t.data.uuid),window.location.href="settle.html"}else window.location.href=xigou.getSessionStorage("buy_now_details_url")}});else if(n)xigou.setSessionStorage("loginjump_url",""),window.location.href=decodeURIComponent(n);else if(xigou.getSessionStorage("refer",!1).indexOf("login.html")>-1||xigou.getSessionStorage("refer",!1).indexOf("logon.html")>-1)window.location.href="home.html";else{if(xigou.getSessionStorage("refer",!1).indexOf("/wxhb")>-1||xigou.getSessionStorage("refer",!1).indexOf("/wxhb.html")>-1)return void(window.location.href="home.html");window.location.href="index.html"}break;case"-99":var r={token:o.data.token,telephone:o.data.tel,name:o.data.name};xigou.setSessionStorage("userinfo",r,!0),$("input#name").val()&&xigou.setLocalStorage("login_name",$("input#name").val()),xigou.setLocalStorage("token",o.token),window.location.href="binding.html";break;default:$("input#name").unbind("change"),$.tips({content:o.msg||"登录失败",stayTime:2e3,type:"warn"})}}else $.tips({content:"请求失败，详见"+o,stayTime:2e3,type:"warn"})}};xigou.activeUser.logon(o)}}),$("#registerBtnClass")[xigou.events.click](function(){window.location.href="register.html"})}function valiDataCallBack(e,o){$.tips({content:e,stayTime:2e3,type:"warn"}),$("#"+o).focus()}function initValiData(){var e={methods:{name:{required:"required",emailormobile:"emailormobile"}},errors:{name:{required:"请输入用户账号",emailormobile:"请填写正确的手机号或者邮箱地址"}}};return xigou.valiformdata.initValiData(e)}$(function(){login(),initValiData()});var backurl=xigou.getQueryString("backurl"),buy_now_details_url=xigou.getSessionStorage("buy_now_details_url"),details_url=xigou.getSessionStorage("details_url"),fanli=xigou.getQueryString("fanli"),_try=xigou.getQueryString("try"),game=xigou.getQueryString("game"),topicid=xigou.getQueryString("topicid"),mtoapp=xigou.getQueryString("mtoapp");"1"==fanli&&$(".registr").attr("href","registr.html?fanli=1"),null!=backurl&&(buy_now_details_url&&($(".back").attr("href","javascript:void(0)"),$(".back")[xigou.events.click](function(){xigou.removeSessionStorage("buy_now_details_url"),window.location.href=decodeURIComponent(buy_now_details_url)})),details_url?($(".back").attr("href","javascript:void(0)"),$(".back")[xigou.events.click](function(){xigou.removeSessionStorage("details_url"),window.location.href=decodeURIComponent(details_url)})):$(".back").attr("href",decodeURIComponent(backurl)));